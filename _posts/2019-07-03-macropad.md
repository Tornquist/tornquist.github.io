---
layout: post
title: "MacroPad"
date: 2019-07-03 11:30:00
categories: programming
custom_css:
- colorbox
- youtube_embed
custom_js:
- photoset-grid
- colorbox
---

A few months back I saw the [RoMac][0] and [Plaid][1] (resp) keyboards on Reddit.

{% include /galleries/2019-07-03-macropad-reference.html %}

I'm a big fan of the exposed design and I've been missing a numberpad on my
S65-X. Due to a misunderstanding I missed the ordering window and took that as a
sign that I should just go ahead and design my own!

I started with the following requirements for design:

* Perfectly square
* All mounted components (no breadboards)
* 12 keys

With a 12 key (4x3 layout) I could theoretically have a perfectly square board if
the length of one size was equal to the space 4 keys would need. That would leave
a 1x4 footprint (in switch units) for the other components. A small board also has
the added benefit of fitting within the Eagle free tier and the JLCPCB $2 prototype
limits.

I started with a QFN ATMEGA32 and designed a circuit around that. It was obvious
very quickly that I'd have to use surface mount components. I didn't have nearly
the amount of space that the plaid has along the top of the board.

The [r/PCB][2] community on Reddit was extremely helpful and gave me great advice
for the first version of the board. I added a ferrite bead between the USB ground
and the chip ground, and adjusted all of the via and trace sizes.

{% include /galleries/2019-07-03-macropad-pcb-review.html %}

If you know anything about switch footprints, you'll immediately see something
off about those designs. I had a nice looking design, but when I went to upload
it to JLCPCB it was listing the physical size as 60x60mm. Measuring against the
keyboard at my desk, that was only about 3.XX keys long. Certainly not the 4x(3+1)
sizing that I was going for.

When I had downloaded the component library, I had assumed that the components
should sit next to each other. That would make it easy to align things, right?
That was a naive assumption, and as I spent more time in the tools, really didn't
make sense. It would be extremely hard to place components if all the footprints
included both the physical size and padding for things that weren't actually
touching the board.

After redesigning the boards again in my giant 76mm x 76mm space, I ended up with
the following design, which I sent off to be printed.

{% include /galleries/2019-07-03-macropad-v1.html %}

When the boards came, I had a chip that required soldering a connection on the back,
and some metric 0603 diodes that I couldn't see with a magnifying lens.

[PICTURES OF CHIPS]

It took me 3 tries to get to the PCB layout that I wanted. I increased a lot of
the component sizes, all focusing around a change in the chip from a QFN to TQFP
package.

When the circuit was correct, I was able to plug it in and see the USB device show
up! That was an exciting moment. From there, it was just configuring QMK and
everything fell into place very quickly.

The board matches my full keyboard and is exactly what I designed it to be. This
project was very different from my normal work, but was really rewarding. There's
something fun about ending up with a physical device.

All in however, I wouldn't recommend my macropad to anyone. It looks like I want,
but it turns out that a single PCB really isn't enough weight to keep something in
place on my desk. The board slides all over the place!

[0]: https://www.reddit.com/r/MechanicalKeyboards/comments/b74x8n/ic_the_romac_a_plaid_inspired_12key_macropad/
[1]: https://github.com/hsgw/plaid
[2]: https://www.reddit.com/r/PCB
